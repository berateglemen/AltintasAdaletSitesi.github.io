<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Site Akışı - Altıntaş Adalet SİTESİ</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        :root { --ana-renk: #f39c12; --koyu-bg: #0f172a; }
        * { cursor: none !important; }
        #cursor { width: 8px; height: 8px; background: var(--ana-renk); border-radius: 50%; position: fixed; z-index: 99999; pointer-events: none; }
        #cursor-ring { width: 35px; height: 35px; border: 1.5px solid var(--ana-renk); border-radius: 50%; position: fixed; z-index: 99998; pointer-events: none; transition: 0.15s ease-out; }
        
        body { 
            background-color: var(--koyu-bg);
            background-image: radial-gradient(#1e293b 1px, transparent 1px);
            background-size: 25px 25px;
            color: #fff; font-family: sans-serif; margin: 0; padding-bottom: 100px;
        }

        .header {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky; top: 0; z-index: 100;
        }

        .container { max-width: 600px; margin: 20px auto; padding: 0 15px; }

        .paylas-box {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 25px;
        }

        textarea {
            width: 100%; background: transparent; border: none;
            color: #fff; resize: none; outline: none; font-size: 15px;
            min-height: 60px;
        }

        .paylas-butonlar {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 10px; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 10px;
        }

        .post-card {
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.05);
            position: relative;
        }

        .profil-satiri { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; }
        .pfp { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; border: 2px solid var(--ana-renk); background: #1e293b; }

        .muhur {
            position: absolute; top: 15px; right: 15px;
            font-size: 8px; font-weight: bold; color: var(--ana-renk);
            border: 1px solid var(--ana-renk); padding: 3px 6px; border-radius: 4px;
            opacity: 0.6;
        }

        .akis-medya { width: 100%; border-radius: 15px; margin-top: 10px; border: 1px solid rgba(255,255,255,0.1); }
        
        .btn-paylas {
            background: var(--ana-renk); border: none; color: #fff;
            padding: 8px 20px; border-radius: 10px; font-weight: bold; cursor: pointer;
        }

        .medya-onizleme { position: relative; display: none; margin-top: 10px; }
        .onizleme-iptal {
            position: absolute; top: 5px; right: 5px;
            background: rgba(0,0,0,0.7); color: #fff; border: none;
            border-radius: 50%; width: 25px; height: 25px; cursor: pointer;
        }
    </style>
</head>
<body onload="baslat()">
    <div id="cursor"></div><div id="cursor-ring"></div>

    <div class="header">
        <a href="anamenu.html" style="color:var(--ana-renk)"><i class="fa fa-chevron-left"></i> Geri</a>
        <b style="letter-spacing: 1px;">SİTE AKIŞI</b>
        <i class="fa fa-refresh" onclick="location.reload()" style="color:var(--ana-renk)"></i>
    </div>

    <div class="container">
        <div class="paylas-box">
            <textarea id="metin" placeholder="Komşularınıza ne söylemek istersiniz?"></textarea>
            
            <div id="medyaAlani" class="medya-onizleme">
                <button class="onizleme-iptal" onclick="medyaIptal()">×</button>
                <img id="imgOnizle" class="akis-medya" style="display:none;">
                <video id="vidOnizle" class="akis-medya" style="display:none;" controls></video>
            </div>

            <div class="paylas-butonlar">
                <label for="medyaSec" style="cursor:pointer; color:var(--ana-renk); font-size:18px;">
                    <i class="fa fa-image"></i>
                </label>
                <input type="file" id="medyaSec" hidden accept="image/*,video/*" onchange="medyaHandle(this)">
                <button class="btn-paylas" onclick="gonder()">YAYINLA</button>
            </div>
        </div>

        <div id="akis">
            </div>
    </div>

    <script>
        let secilenMedyaData = null;
        let medyaTipi = "";

        function baslat() {
            const bd = localStorage.getItem('user_bd');
            if(!bd) window.location.href = "index.html";
        }

        function medyaHandle(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                medyaTipi = input.files[0].type.split('/')[0];
                
                reader.onload = function(e) {
                    secilenMedyaData = e.target.result;
                    document.getElementById('medyaAlani').style.display = "block";
                    if(medyaTipi === "image") {
                        document.getElementById('imgOnizle').src = e.target.result;
                        document.getElementById('imgOnizle').style.display = "block";
                        document.getElementById('vidOnizle').style.display = "none";
                    } else {
                        document.getElementById('vidOnizle').src = e.target.result;
                        document.getElementById('vidOnizle').style.display = "block";
                        document.getElementById('imgOnizle').style.display = "none";
                    }
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function medyaIptal() {
            secilenMedyaData = null;
            document.getElementById('medyaAlani').style.display = "none";
            document.getElementById('medyaSec').value = "";
        }

        function gonder() {
            const txt = document.getElementById('metin').value.trim();
            if(!txt && !secilenMedyaData) return alert("Boş gönderi yapılamaz!");

            const ad = localStorage.getItem('user_name') || "Sakin";
            const bd = localStorage.getItem('user_bd') || "??";
            const foto = localStorage.getItem('user_img') || "https://cdn-icons-png.flaticon.com/512/149/149071.png";

            let medyaHtml = "";
            if(secilenMedyaData) {
                medyaHtml = medyaTipi === "image" 
                    ? `<img src="${secilenMedyaData}" class="akis-medya">` 
                    : `<video src="${secilenMedyaData}" controls class="akis-medya"></video>`;
            }

            const html = `
                <div class="post-card w3-animate-bottom">
                    <div class="muhur">DOĞRULANMIŞ GÖNDERİ</div>
                    <div class="profil-satiri">
                        <img src="${foto}" class="pfp">
                        <div>
                            <b style="color:var(--ana-renk); font-size:14px;">${ad.toUpperCase()}</b>
                            <small style="color:#94a3b8; font-size:11px; display:block;">Daire: ${bd} • Az önce</small>
                        </div>
                    </div>
                    <p style="font-size:15px; line-height:1.5; margin:0;">${txt}</p>
                    ${medyaHtml}
                </div>
            `;
            
            document.getElementById('akis').insertAdjacentHTML('afterbegin', html);
            document.getElementById('metin').value = "";
            medyaIptal();
        }

        // Mouse efekti
        const cur = document.getElementById('cursor'); const ring = document.getElementById('cursor-ring');
        document.addEventListener('mousemove', e => { 
            cur.style.left = e.clientX+'px'; cur.style.top = e.clientY+'px'; 
            ring.animate({left:e.clientX-17.5+'px', top:e.clientY-17.5+'px'}, {duration:400, fill:"forwards"}); 
        });
    </script>
</body>
</html>
